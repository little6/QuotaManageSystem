<?xml version="1.0" encoding="UTF-8"?>
<ViewConfig listener="spring:resultGridCreator#ViewConfigInit">
  <Context>
    <Attribute name="month"/>
    <Attribute name="year"/>
    <Attribute name="viewscope"/>
  </Context>
  <Model>
    <DataType listener="spring:resultGridCreator#initQuotaItemStatus" name="QuotaItemStatus"/>
    <DataType name="DropDownType">
      <PropertyDef name="value">
        <Property name="dataType">String</Property>
      </PropertyDef>
    </DataType>
    <DataType name="Department" meta="x:300;y:165">
      <Property name="creationType">com.bstek.bdf2.core.model.DefaultDept</Property>
      <Property name="defaultDisplayProperty">name</Property>
      <PropertyDef name="id">
        <Property name="dataType">String</Property>
      </PropertyDef>
      <PropertyDef name="name">
        <Property name="dataType">String</Property>
      </PropertyDef>
      <PropertyDef name="desc">
        <Property name="dataType">String</Property>
      </PropertyDef>
      <PropertyDef name="companyId">
        <Property name="dataType">String</Property>
      </PropertyDef>
      <PropertyDef name="createDate">
        <Property name="dataType">Date</Property>
      </PropertyDef>
      <PropertyDef name="parentId">
        <Property name="dataType">String</Property>
      </PropertyDef>
    </DataType>
    <DataType name="User">
      <Property name="creationType">com.bstek.bdf2.core.model.DefaultUser</Property>
      <Property name="defaultDisplayProperty">cname</Property>
      <PropertyDef name="username">
        <Property name="dataType">String</Property>
      </PropertyDef>
      <PropertyDef name="password">
        <Property name="dataType">String</Property>
      </PropertyDef>
      <PropertyDef name="salt">
        <Property name="dataType">String</Property>
      </PropertyDef>
      <PropertyDef name="cname">
        <Property name="dataType">String</Property>
      </PropertyDef>
      <PropertyDef name="ename">
        <Property name="dataType">String</Property>
      </PropertyDef>
      <PropertyDef name="male">
        <Property name="dataType">boolean</Property>
      </PropertyDef>
      <PropertyDef name="enabled">
        <Property name="dataType">boolean</Property>
      </PropertyDef>
      <PropertyDef name="administrator">
        <Property name="dataType">boolean</Property>
      </PropertyDef>
      <PropertyDef name="birthday">
        <Property name="dataType">Date</Property>
      </PropertyDef>
      <PropertyDef name="mobile">
        <Property name="dataType">String</Property>
      </PropertyDef>
      <PropertyDef name="address">
        <Property name="dataType">String</Property>
      </PropertyDef>
      <PropertyDef name="email">
        <Property name="dataType">String</Property>
      </PropertyDef>
      <PropertyDef name="companyId">
        <Property name="dataType">String</Property>
      </PropertyDef>
      <PropertyDef name="createDate">
        <Property name="dataType">Date</Property>
      </PropertyDef>
    </DataType>
    <DataType name="QuotaType" meta="x:825;y:165">
      <Property name="creationType">com.quotamanagesys.model.QuotaType</Property>
      <Property name="autoCreatePropertyDefs">false</Property>
      <PropertyDef name="id">
        <Property name="dataType">String</Property>
      </PropertyDef>
      <PropertyDef name="name">
        <Property name="dataType">String</Property>
      </PropertyDef>
      <PropertyDef name="quotaProfession">
        <Property name="dataType">QuotaProfession</Property>
      </PropertyDef>
      <PropertyDef name="quotaLevel">
        <Property name="dataType">QuotaLevel</Property>
      </PropertyDef>
      <PropertyDef name="quotaDimension">
        <Property name="dataType">QuotaDimension</Property>
      </PropertyDef>
      <PropertyDef name="quotaUnit">
        <Property name="dataType">QuotaUnit</Property>
      </PropertyDef>
      <PropertyDef name="digit">
        <Property name="dataType">int</Property>
      </PropertyDef>
      <PropertyDef name="rate">
        <Property name="dataType">String</Property>
      </PropertyDef>
      <PropertyDef name="manageDept">
        <Property name="dataType">Department</Property>
      </PropertyDef>
      <PropertyDef name="inUsed">
        <Property name="dataType">boolean</Property>
      </PropertyDef>
      <PropertyDef name="calculationFormulaInfo">
        <Property name="dataType">String</Property>
      </PropertyDef>
      <PropertyDef name="quotaDefinitionInfo">
        <Property name="dataType">String</Property>
      </PropertyDef>
    </DataType>
    <DataType name="QuotaProfession" meta="x:375;y:30">
      <Property name="creationType">com.quotamanagesys.model.QuotaProfession</Property>
      <Property name="defaultDisplayProperty">name</Property>
      <PropertyDef name="id">
        <Property name="dataType">String</Property>
      </PropertyDef>
      <PropertyDef name="name">
        <Property name="dataType">String</Property>
      </PropertyDef>
    </DataType>
    <DataType name="QuotaUnit" meta="x:630;y:60">
      <Property name="creationType">com.quotamanagesys.model.QuotaUnit</Property>
      <Property name="defaultDisplayProperty">name</Property>
      <PropertyDef name="id">
        <Property name="dataType">String</Property>
      </PropertyDef>
      <PropertyDef name="name">
        <Property name="dataType">String</Property>
      </PropertyDef>
    </DataType>
    <DataType name="QuotaLevel" meta="x:120;y:360">
      <Property name="creationType">com.quotamanagesys.model.QuotaLevel</Property>
      <Property name="defaultDisplayProperty">name</Property>
      <PropertyDef name="id">
        <Property name="dataType">String</Property>
      </PropertyDef>
      <PropertyDef name="name">
        <Property name="dataType">String</Property>
      </PropertyDef>
      <PropertyDef name="level">
        <Property name="dataType">int</Property>
      </PropertyDef>
    </DataType>
    <DataType name="QuotaDimension" meta="x:570;y:180">
      <Property name="creationType">com.quotamanagesys.model.QuotaDimension</Property>
      <Property name="defaultDisplayProperty">name</Property>
      <PropertyDef name="id">
        <Property name="dataType">String</Property>
      </PropertyDef>
      <PropertyDef name="name">
        <Property name="dataType">String</Property>
      </PropertyDef>
    </DataType>
    <DataType name="QuotaCover" meta="x:945;y:44">
      <Property name="creationType">com.quotamanagesys.model.QuotaCover</Property>
      <Property name="defaultDisplayProperty">name</Property>
      <PropertyDef name="id">
        <Property name="dataType">String</Property>
      </PropertyDef>
      <PropertyDef name="name">
        <Property name="dataType">String</Property>
      </PropertyDef>
    </DataType>
    <DataType name="QuotaItemViewMap">
      <Property name="creationType">com.quotamanagesys.model.QuotaItemViewMap</Property>
      <Property name="defaultDisplayProperty">quotaType.name</Property>
      <PropertyDef name="id">
        <Property name="dataType">String</Property>
      </PropertyDef>
      <PropertyDef name="user">
        <Property name="dataType">User</Property>
      </PropertyDef>
      <PropertyDef name="quotaType">
        <Property name="dataType">QuotaType</Property>
      </PropertyDef>
      <PropertyDef name="quotaCover">
        <Property name="dataType">QuotaCover</Property>
      </PropertyDef>
      <PropertyDef name="canView">
        <Property name="dataType">boolean</Property>
      </PropertyDef>
      <PropertyDef name="defaultView">
        <Property name="dataType">boolean</Property>
      </PropertyDef>
    </DataType>
  </Model>
  <View>
    <Property name="cache">
      <Property name="mode">clientSide</Property>
    </Property>
    <Property name="styleSheetFile">/optv/optvstyle1.css</Property>
    <DataSet id="dsQuotaItemStatus">
      <Property name="dataType">[QuotaItemStatus]</Property>
      <Property name="dataProvider">resultGridCreator#getQuotaItemStatusRecord</Property>
      <Property name="cacheable">false</Property>
      <Property name="pageSize">50</Property>
      <Property name="loadMode">lazy</Property>
    </DataSet>
    <DataSet id="dsQuotaCover">
      <ClientEvent name="beforeLoadData">self.set(&quot;parameter&quot;,{columnName:&quot;口径&quot;});</ClientEvent>
      <Property name="dataProvider">dropDownDataCreator#getDropDownData</Property>
      <Property name="dataType">[DropDownType]</Property>
    </DataSet>
    <DataSet id="dsQuotaLevel">
      <ClientEvent name="beforeLoadData">self.set(&quot;parameter&quot;,{columnName:&quot;指标级别&quot;});</ClientEvent>
      <Property name="dataType">[DropDownType]</Property>
      <Property name="dataProvider">dropDownDataCreator#getDropDownData</Property>
    </DataSet>
    <DataSet id="dsQuotaDimension">
      <ClientEvent name="beforeLoadData">self.set(&quot;parameter&quot;,{columnName:&quot;维度&quot;});</ClientEvent>
      <Property name="dataType">[DropDownType]</Property>
      <Property name="dataProvider">dropDownDataCreator#getDropDownData</Property>
    </DataSet>
    <DataSet id="dsQuotaProfession">
      <ClientEvent name="beforeLoadData">self.set(&quot;parameter&quot;,{columnName:&quot;指标专业&quot;});</ClientEvent>
      <Property name="dataType">[DropDownType]</Property>
      <Property name="dataProvider">dropDownDataCreator#getDropDownData</Property>
    </DataSet>
    <DataSet id="dsManageDept">
      <ClientEvent name="beforeLoadData">self.set(&quot;parameter&quot;,{columnName:&quot;管理部门&quot;});</ClientEvent>
      <Property name="dataType">[DropDownType]</Property>
      <Property name="dataProvider">dropDownDataCreator#getDropDownData</Property>
    </DataSet>
    <DataSet id="dsDutyDept">
      <ClientEvent name="beforeLoadData">self.set(&quot;parameter&quot;,{columnName:&quot;责任部门&quot;});</ClientEvent>
      <Property name="dataType">[DropDownType]</Property>
      <Property name="dataProvider">dropDownDataCreator#getDropDownData</Property>
    </DataSet>
    <DataSet id="dsThisQuotaType">
      <Property name="dataType">QuotaType</Property>
      <Property name="dataProvider">quotaTypeDao#getQuotaType</Property>
    </DataSet>
    <ToolBar>
      <Property name="fixRight">true</Property>
      <Separator/>
      <ToolBarLabel>
        <Property name="text">年度</Property>
      </ToolBarLabel>
      <TextEditor id="teYear">
        <ClientEvent name="onReady">var date=new Date();&#xD;
var year;&#xD;
var month=date.getMonth();&#xD;
&#xD;
var Sys = {};&#xD;
var ua = navigator.userAgent.toLowerCase();&#xD;
window.ActiveXObject ? Sys.ie = ua.match(/msie ([\d.]+)/)[1] :&#xD;
document.getBoxObjectFor ? Sys.firefox = ua.match(/firefox\/([\d.]+)/)[1] :&#xD;
window.MessageEvent &amp;&amp; !document.getBoxObjectFor ? Sys.chrome = ua.match(/chrome\/([\d.]+)/)[1] :&#xD;
window.opera ? Sys.opera = ua.match(/opera.([\d.]+)/)[1] :&#xD;
window.openDatabase ? Sys.safari = ua.match(/version\/([\d.]+)/)[1] : 0;&#xD;
&#xD;
//以下进行测试&#xD;
if(Sys.ie){&#xD;
	year=(date.getYear());&#xD;
}else if(Sys.chrome){&#xD;
	year=(date.getYear())+1900;&#xD;
}&#xD;
&#xD;
if(month==0){&#xD;
	year=year-1;&#xD;
}&#xD;
self.set(&quot;text&quot;,year);&#xD;
view.set(&quot;context.year&quot;,year);</ClientEvent>
        <Property name="trigger">yddYear</Property>
        <Property name="width">70</Property>
      </TextEditor>
      <ToolBarLabel>
        <Property name="text">月度</Property>
      </ToolBarLabel>
      <TextEditor id="teMonth">
        <ClientEvent name="onReady">var date=new Date();&#xD;
var year;&#xD;
var month=date.getMonth();&#xD;
&#xD;
if(month==0){&#xD;
	month=12;&#xD;
}&#xD;
self.set(&quot;text&quot;,month);&#xD;
view.set(&quot;context.month&quot;,month);</ClientEvent>
        <Property name="trigger">lddMonth</Property>
        <Property name="width">70</Property>
      </TextEditor>
      <Separator/>
      <ToolBarButton>
        <ClientEvent name="onClick">var teYear=view.get(&quot;#teYear&quot;);&#xD;
var year=parseInt(teYear.get(&quot;text&quot;));&#xD;
var teMonth=view.get(&quot;#teMonth&quot;);&#xD;
var month=teMonth.get(&quot;text&quot;);&#xD;
switch(month){&#xD;
	case &quot;月度&quot;:&#xD;
		month=13;&#xD;
		break;&#xD;
	case &quot;年度&quot;:&#xD;
		month=14;&#xD;
		break;&#xD;
	case &quot;全部&quot;:&#xD;
		month=15;&#xD;
		break;&#xD;
	default:&#xD;
		month=parseInt(teMonth.get(&quot;text&quot;));&#xD;
		break;&#xD;
}&#xD;
&#xD;
view.set(&quot;context.year&quot;,year);&#xD;
view.set(&quot;context.month&quot;,month);&#xD;
view.set(&quot;context.viewscope&quot;,&quot;can&quot;);&#xD;
&#xD;
var dsQuotaItemStatus=view.get(&quot;#dsQuotaItemStatus&quot;);&#xD;
dsQuotaItemStatus.flushAsync();&#xD;
&#xD;
//刷新下拉列表的数据&#xD;
var dsQuotaCover=view.get(&quot;#dsQuotaCover&quot;);&#xD;
dsQuotaCover.set(&quot;parameter&quot;,{columnName:&quot;口径&quot;}).flushAsync();&#xD;
var dsQuotaLevel=view.get(&quot;#dsQuotaLevel&quot;);&#xD;
dsQuotaLevel.set(&quot;parameter&quot;,{columnName:&quot;指标级别&quot;}).flushAsync();&#xD;
var dsQuotaDimension=view.get(&quot;#dsQuotaDimension&quot;);&#xD;
dsQuotaDimension.set(&quot;parameter&quot;,{columnName:&quot;维度&quot;}).flushAsync();&#xD;
var dsManageDept=view.get(&quot;#dsManageDept&quot;);&#xD;
dsManageDept.set(&quot;parameter&quot;,{columnName:&quot;管理部门&quot;}).flushAsync();&#xD;
var dsDutyDept=view.get(&quot;#dsDutyDept&quot;);&#xD;
dsDutyDept.set(&quot;parameter&quot;,{columnName:&quot;责任部门&quot;}).flushAsync();</ClientEvent>
        <Property name="caption">可见指标</Property>
        <Property name="icon">url(>skin>common/icons.gif) -60px -100px</Property>
      </ToolBarButton>
      <ToolBarButton>
        <ClientEvent name="onClick">var teYear=view.get(&quot;#teYear&quot;);&#xD;
var year=parseInt(teYear.get(&quot;text&quot;));&#xD;
var teMonth=view.get(&quot;#teMonth&quot;);&#xD;
var month=teMonth.get(&quot;text&quot;);&#xD;
switch(month){&#xD;
	case &quot;月度&quot;:&#xD;
		month=13;&#xD;
		break;&#xD;
	case &quot;年度&quot;:&#xD;
		month=14;&#xD;
		break;&#xD;
	case &quot;全部&quot;:&#xD;
		month=15;&#xD;
		break;&#xD;
	default:&#xD;
		month=parseInt(teMonth.get(&quot;text&quot;));&#xD;
		break;&#xD;
}&#xD;
&#xD;
&#xD;
view.set(&quot;context.year&quot;,year);&#xD;
view.set(&quot;context.month&quot;,month);&#xD;
view.set(&quot;context.viewscope&quot;,&quot;default&quot;);&#xD;
&#xD;
var dsQuotaItemStatus=view.get(&quot;#dsQuotaItemStatus&quot;);&#xD;
dsQuotaItemStatus.flushAsync();&#xD;
&#xD;
//刷新下拉列表的数据&#xD;
var dsQuotaCover=view.get(&quot;#dsQuotaCover&quot;);&#xD;
dsQuotaCover.set(&quot;parameter&quot;,{columnName:&quot;口径&quot;}).flushAsync();&#xD;
var dsQuotaLevel=view.get(&quot;#dsQuotaLevel&quot;);&#xD;
dsQuotaLevel.set(&quot;parameter&quot;,{columnName:&quot;指标级别&quot;}).flushAsync();&#xD;
var dsQuotaDimension=view.get(&quot;#dsQuotaDimension&quot;);&#xD;
dsQuotaDimension.set(&quot;parameter&quot;,{columnName:&quot;维度&quot;}).flushAsync();&#xD;
var dsManageDept=view.get(&quot;#dsManageDept&quot;);&#xD;
dsManageDept.set(&quot;parameter&quot;,{columnName:&quot;管理部门&quot;}).flushAsync();&#xD;
var dsDutyDept=view.get(&quot;#dsDutyDept&quot;);&#xD;
dsDutyDept.set(&quot;parameter&quot;,{columnName:&quot;责任部门&quot;}).flushAsync();</ClientEvent>
        <Property name="caption">默认指标</Property>
        <Property name="icon">url(>skin>common/icons.gif) -80px -100px</Property>
      </ToolBarButton>
      <Separator/>
      <ToolBarButton>
        <ClientEvent name="onClick">window.location.reload();</ClientEvent>
        <Property name="caption">刷新页面</Property>
        <Property name="icon">url(>skin>common/icons.gif) -40px -240px</Property>
      </ToolBarButton>
      <MenuButton>
        <Property name="caption">重置</Property>
        <Property name="icon">url(>skin>common/icons.gif) -280px -220px</Property>
        <MenuItem>
          <ClientEvent name="onClick">var aaCalculateAll=view.get(&quot;#aaCalculateAll&quot;);&#xD;
var aaCreateOrUpdateAll=view.get(&quot;#aaCreateOrUpdateAll&quot;);&#xD;
&#xD;
aaCalculateAll.execute({&#xD;
	callback : function(success, obj){&#xD;
		if (success) {&#xD;
			aaCreateOrUpdateAll.execute({&#xD;
				callback : function(success, obj){&#xD;
					if (success) {&#xD;
						&#xD;
			        }&#xD;
					else{}&#xD;
				}&#xD;
			});&#xD;
        }&#xD;
		else{}}&#xD;
});</ClientEvent>
          <Property name="caption">重置全部</Property>
          <Property name="icon">url(>skin>common/icons.gif) -280px -220px</Property>
        </MenuItem>
        <MenuItem>
          <ClientEvent name="onClick">var aaCalculateAll=view.get(&quot;#aaCalculateAll&quot;);&#xD;
&#xD;
aaCalculateAll.execute({&#xD;
	callback : function(success, obj){&#xD;
		if (success) {&#xD;
			&#xD;
        }&#xD;
		else{}}&#xD;
});</ClientEvent>
          <Property name="caption">重置计算结果</Property>
          <Property name="icon">url(>skin>common/icons.gif) -280px -220px</Property>
        </MenuItem>
        <MenuItem>
          <ClientEvent name="onClick">var aaCreateOrUpdateAll=view.get(&quot;#aaCreateOrUpdateAll&quot;);&#xD;
&#xD;
aaCreateOrUpdateAll.execute({&#xD;
	callback : function(success, obj){&#xD;
		if (success) {&#xD;
			&#xD;
        }&#xD;
		else{}}&#xD;
});</ClientEvent>
          <Property name="caption">重置数据表</Property>
          <Property name="icon">url(>skin>common/icons.gif) -280px -220px</Property>
        </MenuItem>
      </MenuButton>
      <Separator/>
      <ToolBarButton>
        <ClientEvent name="onClick">var dsUser=view.get(&quot;#dsUser&quot;);&#xD;
var userId=dsUser.getData().first().get(&quot;username&quot;);&#xD;
var dsQuotaItemViewMap=view.get(&quot;#dsQuotaItemViewMap&quot;);&#xD;
&#xD;
dsQuotaItemViewMap.set(&quot;parameter&quot;,{userId:userId});&#xD;
&#xD;
view.get(&quot;#dlgQuotaItemViewMap&quot;).show();&#xD;
dsQuotaItemViewMap.flushAsync();&#xD;
arg.processDefault=false;</ClientEvent>
        <Property name="caption">设置默认指标</Property>
        <Property name="icon">url(>skin>common/icons.gif) -100px -20px</Property>
      </ToolBarButton>
      <ToolBarButton>
        <ClientEvent name="onClick">var teYear=view.get(&quot;#teYear&quot;);&#xD;
var year=parseInt(teYear.get(&quot;text&quot;));&#xD;
var teMonth=view.get(&quot;#teMonth&quot;);&#xD;
var month=teMonth.get(&quot;text&quot;);&#xD;
&#xD;
var teYear2=view.get(&quot;#teYear2&quot;);&#xD;
var teMonth2=view.get(&quot;#teMonth2&quot;);&#xD;
&#xD;
teYear2.set(&quot;text&quot;,year);&#xD;
&#xD;
switch(month){&#xD;
	case &quot;月度&quot;:&#xD;
		month=13;&#xD;
		teMonth2.set(&quot;text&quot;,0);&#xD;
		break;&#xD;
	case &quot;年度&quot;:&#xD;
		month=14;&#xD;
		teMonth2.set(&quot;text&quot;,0);&#xD;
		break;&#xD;
	case &quot;全部&quot;:&#xD;
		month=15;&#xD;
		teMonth2.set(&quot;text&quot;,0);&#xD;
		break;&#xD;
	default:&#xD;
		month=parseInt(teMonth.get(&quot;text&quot;));&#xD;
		teMonth2.set(&quot;text&quot;,month);&#xD;
		break;&#xD;
}&#xD;
&#xD;
var dlgKeyPointQuotaItemView=view.get(&quot;#dlgKeyPointQuotaItemView&quot;);&#xD;
dlgKeyPointQuotaItemView.show();&#xD;
</ClientEvent>
        <Property name="caption">关键业绩考核指标</Property>
        <Property name="icon">url(>skin>common/icons.gif) -40px -20px</Property>
      </ToolBarButton>
      <ToolBarButton>
        <ClientEvent name="onClick">var teYear=view.get(&quot;#teYear&quot;);&#xD;
var year=parseInt(teYear.get(&quot;text&quot;));&#xD;
var teMonth=view.get(&quot;#teMonth&quot;);&#xD;
var month=teMonth.get(&quot;text&quot;);&#xD;
switch(month){&#xD;
	case &quot;月度&quot;:&#xD;
		month=13;&#xD;
		break;&#xD;
	case &quot;年度&quot;:&#xD;
		month=14;&#xD;
		break;&#xD;
	case &quot;全部&quot;:&#xD;
		month=15;&#xD;
		break;&#xD;
	default:&#xD;
		month=parseInt(teMonth.get(&quot;text&quot;));&#xD;
		break;&#xD;
}&#xD;
&#xD;
var aaWriteExcel2=view.get(&quot;#aaWriteExcel2&quot;);&#xD;
aaWriteExcel2.set(&quot;parameter&quot;,{year:year,month:month});&#xD;
aaWriteExcel2.execute({&#xD;
	callback : function(success, obj){&#xD;
		if (success) {&#xD;
			var aaDownLoadFile2=view.get(&quot;#aaDownLoadFile2&quot;);&#xD;
			aaDownLoadFile2.set(&quot;parameter&quot;,{year:year,month:month});&#xD;
			aaDownLoadFile2.execute();&#xD;
        }&#xD;
	}&#xD;
});</ClientEvent>
        <Property name="caption">下载（办公室）</Property>
        <Property name="icon">url(>skin>common/icons.gif) -140px -240px</Property>
      </ToolBarButton>
      <Fill/>
      <DataPilot>
        <Property name="itemCodes">pages,pageSize</Property>
        <Property name="dataSet">dsQuotaItemStatus</Property>
      </DataPilot>
      <Separator/>
      <ToolBarButton>
        <ClientEvent name="onClick">var aaDownloadHelpFile=view.get(&quot;#aaDownloadHelpFile&quot;);&#xD;
aaDownloadHelpFile.set(&quot;parameter&quot;,{helpname:&quot;QuotaItemView&quot;});&#xD;
aaDownloadHelpFile.execute();</ClientEvent>
        <Property name="caption">帮助</Property>
        <Property name="icon">url(>skin>common/icons.gif) -180px -0px</Property>
      </ToolBarButton>
      <Separator/>
    </ToolBar>
    <DataGrid id="dgQuotaItemStatus" listener="spring:resultGridCreator#DataGridInit">
      <ClientEvent name="onDoubleClick">var currentQuotaItemStatus=self.getCurrentItem();&#xD;
quotaTypeId=currentQuotaItemStatus.get(&quot;指标种类id&quot;);&#xD;
&#xD;
var dsThisQuotaType=view.get(&quot;#dsThisQuotaType&quot;);&#xD;
dsThisQuotaType.set(&quot;parameter&quot;,{id:quotaTypeId});&#xD;
dsThisQuotaType.flush();&#xD;
&#xD;
var dlgQuotaTypeTip=view.get(&quot;#dlgQuotaTypeTip&quot;);&#xD;
dlgQuotaTypeTip.show();&#xD;
var taTip=view.get(&quot;#taTip&quot;);&#xD;
&#xD;
var calculationFormulaInfo=dsThisQuotaType.getData().get(&quot;calculationFormulaInfo&quot;);&#xD;
var quotaDefinitionInfo=dsThisQuotaType.getData().get(&quot;quotaDefinitionInfo&quot;);&#xD;
if(calculationFormulaInfo==null){&#xD;
	calculationFormulaInfo=&quot;暂无定义&quot;;&#xD;
}&#xD;
if(quotaDefinitionInfo==null){&#xD;
	quotaDefinitionInfo=&quot;暂无定义&quot;;&#xD;
}&#xD;
var text=&quot;1、统计公式：&quot;+calculationFormulaInfo+&quot;\n&quot;+&quot;2、指标定义：&quot;+quotaDefinitionInfo+&quot;\n&quot;;&#xD;
taTip.set(&quot;text&quot;,text);</ClientEvent>
      <Property name="readOnly">true</Property>
      <Property name="supportsPaging">false</Property>
      <Property name="showFilterBar">true</Property>
      <Property name="scrollMode">lazyRender</Property>
      <Property name="filterMode">serverSide</Property>
    </DataGrid>
    <AjaxAction id="aaCalculateAll">
      <Property name="service">calculateCore#calculateAll</Property>
      <Property name="executingMessage">正在生成计算结果...</Property>
      <Property name="successMessage">计算完成！</Property>
    </AjaxAction>
    <AjaxAction id="aaCreateOrUpdateAll">
      <Property name="service">resultTableCreator#createOrUpdateAll</Property>
      <Property name="executingMessage">正在更新统计表...</Property>
      <Property name="successMessage">更新完成！</Property>
    </AjaxAction>
    <YearDropDown id="yddYear"/>
    <DataSetDropDown id="dsddQuotaCover">
      <Property name="dataSet">dsQuotaCover</Property>
      <Property name="property">value</Property>
      <DataColumn>
        <Property name="name">value</Property>
        <Property name="property">value</Property>
        <Property name="caption">口径</Property>
        <Editor/>
      </DataColumn>
    </DataSetDropDown>
    <DataSetDropDown id="dsddQuotaLevel">
      <Property name="dataSet">dsQuotaLevel</Property>
      <Property name="property">value</Property>
      <DataColumn>
        <Property name="name">value</Property>
        <Property name="property">value</Property>
        <Property name="caption">级别</Property>
        <Editor/>
      </DataColumn>
    </DataSetDropDown>
    <DataSetDropDown id="dsddQuotaDimension">
      <Property name="dataSet">dsQuotaDimension</Property>
      <Property name="property">value</Property>
      <DataColumn>
        <Property name="name">value</Property>
        <Property name="property">value</Property>
        <Property name="caption">维度</Property>
        <Editor/>
      </DataColumn>
    </DataSetDropDown>
    <DataSetDropDown id="dsddQuotaProfession">
      <Property name="dataSet">dsQuotaProfession</Property>
      <Property name="property">value</Property>
      <DataColumn>
        <Property name="name">value</Property>
        <Property name="property">value</Property>
        <Property name="caption">专业</Property>
        <Editor/>
      </DataColumn>
    </DataSetDropDown>
    <DataSetDropDown id="dsddManageDept">
      <Property name="dataSet">dsManageDept</Property>
      <Property name="property">value</Property>
      <DataColumn>
        <Property name="name">value</Property>
        <Property name="property">value</Property>
        <Property name="caption">管理部门</Property>
        <Editor/>
      </DataColumn>
    </DataSetDropDown>
    <DataSetDropDown id="dsddDutyDept">
      <Property name="dataSet">dsDutyDept</Property>
      <Property name="property">value</Property>
      <DataColumn>
        <Property name="name">value</Property>
        <Property name="property">value</Property>
        <Property name="caption">责任部门</Property>
        <Editor/>
      </DataColumn>
    </DataSetDropDown>
    <ListDropDown id="lddOverTime">
      <Property name="items">
        <Collection>
          <Entity>
            <Property name="label">超时</Property>
            <Property name="key">TRUE</Property>
          </Entity>
          <Entity>
            <Property name="label">未超时</Property>
            <Property name="key">FALSE</Property>
          </Entity>
        </Collection>
      </Property>
      <Property name="displayProperty">label</Property>
      <Property name="property">key</Property>
    </ListDropDown>
    <ListDropDown id="lddLight">
      <Property name="items">
        <Collection>
          <Entity>
            <Property name="label">红灯</Property>
            <Property name="key">0.0</Property>
          </Entity>
          <Entity>
            <Property name="label">绿灯</Property>
            <Property name="key">1.0</Property>
          </Entity>
        </Collection>
      </Property>
      <Property name="displayProperty">label</Property>
      <Property name="property">key</Property>
    </ListDropDown>
    <ListDropDown id="lddMonth">
      <Property name="items">
        <Collection>
          <Entity>
            <Property name="label">一月</Property>
            <Property name="key">1</Property>
          </Entity>
          <Entity>
            <Property name="label">二月</Property>
            <Property name="key">2</Property>
          </Entity>
          <Entity>
            <Property name="label">三月</Property>
            <Property name="key">3</Property>
          </Entity>
          <Entity>
            <Property name="label">四月</Property>
            <Property name="key">4</Property>
          </Entity>
          <Entity>
            <Property name="label">五月</Property>
            <Property name="key">5</Property>
          </Entity>
          <Entity>
            <Property name="label">六月</Property>
            <Property name="key">6</Property>
          </Entity>
          <Entity>
            <Property name="label">七月</Property>
            <Property name="key">7</Property>
          </Entity>
          <Entity>
            <Property name="label">八月</Property>
            <Property name="key">8</Property>
          </Entity>
          <Entity>
            <Property name="label">九月</Property>
            <Property name="key">9</Property>
          </Entity>
          <Entity>
            <Property name="label">十月</Property>
            <Property name="key">10</Property>
          </Entity>
          <Entity>
            <Property name="label">十一月</Property>
            <Property name="key">11</Property>
          </Entity>
          <Entity>
            <Property name="label">十二月</Property>
            <Property name="key">12</Property>
          </Entity>
          <Entity>
            <Property name="label">月度</Property>
            <Property name="key">月度</Property>
          </Entity>
          <Entity>
            <Property name="label">年度</Property>
            <Property name="key">年度</Property>
          </Entity>
          <Entity>
            <Property name="label">全部</Property>
            <Property name="key">全部</Property>
          </Entity>
        </Collection>
      </Property>
      <Property name="property">key</Property>
      <Property name="displayProperty">label</Property>
    </ListDropDown>
    <ListDropDown id="lddMonth2">
      <Property name="items">
        <Collection>
          <Entity>
            <Property name="label">一月</Property>
            <Property name="key">1</Property>
          </Entity>
          <Entity>
            <Property name="label">二月</Property>
            <Property name="key">2</Property>
          </Entity>
          <Entity>
            <Property name="label">三月</Property>
            <Property name="key">3</Property>
          </Entity>
          <Entity>
            <Property name="label">四月</Property>
            <Property name="key">4</Property>
          </Entity>
          <Entity>
            <Property name="label">五月</Property>
            <Property name="key">5</Property>
          </Entity>
          <Entity>
            <Property name="label">六月</Property>
            <Property name="key">6</Property>
          </Entity>
          <Entity>
            <Property name="label">七月</Property>
            <Property name="key">7</Property>
          </Entity>
          <Entity>
            <Property name="label">八月</Property>
            <Property name="key">8</Property>
          </Entity>
          <Entity>
            <Property name="label">九月</Property>
            <Property name="key">9</Property>
          </Entity>
          <Entity>
            <Property name="label">十月</Property>
            <Property name="key">10</Property>
          </Entity>
          <Entity>
            <Property name="label">十一月</Property>
            <Property name="key">11</Property>
          </Entity>
          <Entity>
            <Property name="label">十二月</Property>
            <Property name="key">12</Property>
          </Entity>
        </Collection>
      </Property>
      <Property name="property">key</Property>
      <Property name="displayProperty">label</Property>
    </ListDropDown>
    <ListDropDown id="lddRate">
      <Property name="items">
        <Collection>
          <Value>年</Value>
          <Value>月</Value>
        </Collection>
      </Property>
    </ListDropDown>
    <ListDropDown id="lddSubmitStatus">
      <Property name="items">
        <Collection>
          <Entity>
            <Property name="label">已提交</Property>
            <Property name="key">TRUE</Property>
          </Entity>
          <Entity>
            <Property name="label">未提交</Property>
            <Property name="key">FALSE</Property>
          </Entity>
        </Collection>
      </Property>
      <Property name="displayProperty">label</Property>
      <Property name="property">key</Property>
      <Property name="ignored">false</Property>
      <Property name="filterOnOpen">false</Property>
      <Property name="editable">true</Property>
      <Property name="dynaFilter">false</Property>
      <Property name="useEmptyItem">false</Property>
      <Property name="autoOpen">false</Property>
      <Property name="buttonVisible">true</Property>
      <Property name="postValueOnSelect">true</Property>
      <Property name="filterOnTyping">true</Property>
    </ListDropDown>
    <DataSet id="dsUser">
      <Property name="dataType">[User]</Property>
      <Property name="dataProvider">userDao#getLoginUsers</Property>
    </DataSet>
    <DataSet id="dsQuotaItemViewMap">
      <Property name="dataType">[QuotaItemViewMap]</Property>
      <Property name="dataProvider">quotaItemViewMapDao#getQuotaItemViewMapsByUserWithPage</Property>
      <Property name="pageSize">50</Property>
    </DataSet>
    <Dialog id="dlgQuotaItemViewMap">
      <Property name="width">700</Property>
      <Property name="height">450</Property>
      <Property name="caption">设置默认显示的指标</Property>
      <Property name="shadowMode">frame</Property>
      <Property name="floating">true</Property>
      <Buttons/>
      <Children>
        <Container>
          <ToolBar>
            <DataPilot>
              <Property name="itemCodes">pages,pageSize</Property>
              <Property name="dataSet">dsQuotaItemViewMap</Property>
            </DataPilot>
            <Separator/>
            <ToolBarButton>
              <ClientEvent name="onClick">var dsUser=view.get(&quot;#dsUser&quot;);&#xD;
var userId=dsUser.getData().first().get(&quot;username&quot;);&#xD;
var dlgQuotaItemViewMap=view.get(&quot;#dlgQuotaItemViewMap&quot;);&#xD;
&#xD;
var dgQuotaItemViewMap=view.get(&quot;#dgQuotaItemViewMap&quot;);&#xD;
var dsQuotaItemViewMap=view.get(&quot;#dsQuotaItemViewMap&quot;);&#xD;
var uaQuotaItemViewMap=view.get(&quot;#uaQuotaItemViewMap&quot;);&#xD;
&#xD;
uaQuotaItemViewMap.execute({&#xD;
	callback:function(success,obj){&#xD;
		if (success) {&#xD;
			dsQuotaItemViewMap.set(&quot;parameter&quot;,{userId:userId}).flushAsync();&#xD;
			dgQuotaItemViewMap.refresh();&#xD;
			dlgQuotaItemViewMap.hide();&#xD;
			window.location.reload();&#xD;
		}else{&#xD;
			//alert(&quot;执行失败！发生异常：&quot; + obj)&#xD;
			dlgQuotaItemViewMap.hide();&#xD;
		}&#xD;
	}&#xD;
})</ClientEvent>
              <Property name="caption">保存</Property>
              <Property name="icon">url(>skin>common/icons.gif) -140px -20px</Property>
            </ToolBarButton>
          </ToolBar>
          <DataGrid id="dgQuotaItemViewMap">
            <ClientEvent name="onContextMenu">var muUpdateViewMaps1=view.get(&quot;#muUpdateViewMaps1&quot;);&#xD;
muUpdateViewMaps1.show(&#xD;
	{&#xD;
		position:{&#xD;
			left:arg.event.pageX,&#xD;
			top:arg.event.pageY&#xD;
		}&#xD;
	}&#xD;
);</ClientEvent>
            <Property name="dataSet">dsQuotaItemViewMap</Property>
            <Property name="dataType">QuotaItemViewMap</Property>
            <Property name="dynaRowHeight">true</Property>
            <Property name="selectionMode">multiRows</Property>
            <Property name="stretchColumnsMode">allColumns</Property>
            <Property name="filterMode">serverSide</Property>
            <Property name="showFilterBar">true</Property>
            <RowNumColumn/>
            <DataColumn name="id">
              <Property name="property">id</Property>
              <Property name="visible">false</Property>
              <Property name="readOnly">true</Property>
            </DataColumn>
            <DataColumn name="user">
              <Property name="property">user</Property>
              <Property name="visible">false</Property>
              <Property name="readOnly">true</Property>
            </DataColumn>
            <DataColumn name="quotaType">
              <Property name="property">quotaType</Property>
              <Property name="editable">true</Property>
              <Property name="wrappable">true</Property>
              <Property name="caption">指标种类</Property>
              <Property name="readOnly">true</Property>
              <Property name="width">220</Property>
              <Property name="visible">false</Property>
            </DataColumn>
            <DataColumn>
              <Property name="property">quotaType.name</Property>
              <Property name="caption">指标</Property>
              <Property name="align">center</Property>
              <Property name="width">200</Property>
              <Property name="editable">true</Property>
              <Property name="name">quotaTypeName</Property>
              <Property name="readOnly">true</Property>
              <Editor/>
            </DataColumn>
            <DataColumn>
              <Property name="name">quotaProfessionName</Property>
              <Property name="property">quotaType.quotaProfession.name</Property>
              <Property name="align">center</Property>
              <Property name="caption">专业</Property>
              <Property name="readOnly">true</Property>
              <Property name="width">100</Property>
              <Property name="editable">true</Property>
              <Editor/>
            </DataColumn>
            <DataColumn>
              <Property name="property">quotaType.manageDept.name</Property>
              <Property name="caption">管理部门</Property>
              <Property name="align">center</Property>
              <Property name="width">100</Property>
              <Property name="editable">true</Property>
              <Property name="name">manageDeptName</Property>
              <Property name="readOnly">true</Property>
              <Property name="trigger">dsddManageDept</Property>
              <Editor/>
            </DataColumn>
            <DataColumn>
              <Property name="property">quotaType.quotaLevel.name</Property>
              <Property name="caption">级别</Property>
              <Property name="align">center</Property>
              <Property name="width">60</Property>
              <Property name="editable">true</Property>
              <Property name="name">quotaTypeLevelName</Property>
              <Property name="readOnly">true</Property>
              <Property name="trigger">dsddQuotaLevel</Property>
              <Editor/>
            </DataColumn>
            <DataColumn>
              <Property name="property">quotaType.rate</Property>
              <Property name="caption">频率</Property>
              <Property name="align">center</Property>
              <Property name="width">60</Property>
              <Property name="editable">true</Property>
              <Property name="name">rate</Property>
              <Property name="readOnly">true</Property>
              <Editor/>
            </DataColumn>
            <DataColumn name="quotaCover">
              <Property name="property">quotaCover</Property>
              <Property name="editable">true</Property>
              <Property name="align">center</Property>
              <Property name="caption">口径</Property>
              <Property name="readOnly">true</Property>
              <Property name="width">65</Property>
              <Property name="visible">false</Property>
            </DataColumn>
            <DataColumn>
              <Property name="property">quotaCover.name</Property>
              <Property name="caption">口径</Property>
              <Property name="align">center</Property>
              <Property name="width">65</Property>
              <Property name="name">quotaCoverName</Property>
              <Property name="editable">true</Property>
              <Property name="readOnly">true</Property>
              <Property name="trigger">dsddQuotaCover</Property>
              <Editor/>
            </DataColumn>
            <DataColumn name="canView">
              <Property name="property">canView</Property>
              <Property name="align">center</Property>
              <Property name="caption">可见</Property>
              <Property name="width">60</Property>
              <Property name="visible">false</Property>
              <Property name="readOnly">true</Property>
            </DataColumn>
            <DataColumn name="defaultView">
              <Property name="property">defaultView</Property>
              <Property name="align">center</Property>
              <Property name="caption">默认</Property>
              <Property name="width">60</Property>
            </DataColumn>
          </DataGrid>
          <UpdateAction id="uaQuotaItemViewMap">
            <Property name="dataResolver">quotaItemViewMapDao#saveQuotaItemViewMaps</Property>
            <UpdateItem>
              <Property name="dataSet">dsQuotaItemViewMap</Property>
            </UpdateItem>
          </UpdateAction>
          <AjaxAction id="aaUpdateQuotaItemViewMapsDefaultView">
            <Property name="service">quotaItemViewMapDao#updateQuotaItemViewMapsDefaultView</Property>
          </AjaxAction>
          <Menu id="muUpdateViewMaps1">
            <MenuItem>
              <ClientEvent name="onClick">var dsUser=view.get(&quot;#dsUser&quot;);&#xD;
var userId=dsUser.getData().first().get(&quot;username&quot;);&#xD;
&#xD;
var aaUpdateQuotaItemViewMapsDefaultView=view.get(&quot;#aaUpdateQuotaItemViewMapsDefaultView&quot;);&#xD;
&#xD;
aaUpdateQuotaItemViewMapsDefaultView.set(&quot;parameter&quot;,{userId:userId,isDefaultToView:true});&#xD;
aaUpdateQuotaItemViewMapsDefaultView.execute({&#xD;
	callback : function(success, obj){&#xD;
		if (success) {&#xD;
			var dgQuotaItemViewMap=view.get(&quot;#dgQuotaItemViewMap&quot;);&#xD;
			var dsQuotaItemViewMap=view.get(&quot;#dsQuotaItemViewMap&quot;);&#xD;
			&#xD;
			dsQuotaItemViewMap.set(&quot;parameter&quot;,{userId:userId}).flushAsync();&#xD;
			dgQuotaItemViewMap.refresh();&#xD;
        }&#xD;
		else{}}&#xD;
});</ClientEvent>
              <Property name="caption">设置当前筛选出的指标为默认</Property>
              <Property name="icon">url(>skin>common/icons.gif) -180px -100px</Property>
            </MenuItem>
            <MenuItem>
              <ClientEvent name="onClick">var dsUser=view.get(&quot;#dsUser&quot;);&#xD;
var userId=dsUser.getData().first().get(&quot;username&quot;);&#xD;
&#xD;
var aaUpdateQuotaItemViewMapsDefaultView=view.get(&quot;#aaUpdateQuotaItemViewMapsDefaultView&quot;);&#xD;
&#xD;
aaUpdateQuotaItemViewMapsDefaultView.set(&quot;parameter&quot;,{userId:userId,isDefaultToView:false});&#xD;
aaUpdateQuotaItemViewMapsDefaultView.execute({&#xD;
	callback : function(success, obj){&#xD;
		if (success) {&#xD;
			var dgQuotaItemViewMap=view.get(&quot;#dgQuotaItemViewMap&quot;);&#xD;
			var dsQuotaItemViewMap=view.get(&quot;#dsQuotaItemViewMap&quot;);&#xD;
			&#xD;
			dsQuotaItemViewMap.set(&quot;parameter&quot;,{userId:userId}).flushAsync();&#xD;
			dgQuotaItemViewMap.refresh();&#xD;
        }&#xD;
		else{}}&#xD;
});</ClientEvent>
              <Property name="caption">设置当前筛选出的指标为不默认</Property>
              <Property name="icon">url(>skin>common/icons.gif) -180px -100px</Property>
            </MenuItem>
          </Menu>
        </Container>
      </Children>
      <Tools/>
    </Dialog>
    <DownloadAction id="aaDownLoadFile">
      <Property name="fileProvider">downLoadFile#download</Property>
      <Property name="parameter"></Property>
      <Property name="inlineMode">browser</Property>
    </DownloadAction>
    <AjaxAction id="aaWriteExcel">
      <Property name="service">writeExcel#writeExcel</Property>
    </AjaxAction>
    <Dialog id="dlgQuotaTypeTip">
      <Property name="caption">指标说明</Property>
      <Property name="width">700</Property>
      <Property name="height">200</Property>
      <Buttons/>
      <Children>
        <Container>
          <TextArea id="taTip">
            <Property name="editable">false</Property>
            <Property name="readOnly">true</Property>
          </TextArea>
        </Container>
      </Children>
      <Tools/>
    </Dialog>
    <DownloadAction id="aaDownloadHelpFile">
      <Property name="fileProvider">userHelpCenter#getHelpBook</Property>
      <Property name="inlineMode">browser</Property>
      <Property name="caption">下载该模块说明书</Property>
    </DownloadAction>
    <DownloadAction id="aaDownLoadFile2">
      <Property name="fileProvider">downLoadFile#download2</Property>
      <Property name="parameter"></Property>
      <Property name="inlineMode">browser</Property>
    </DownloadAction>
    <AjaxAction id="aaWriteExcel2">
      <Property name="service">writeExcel#writeExcel2</Property>
    </AjaxAction>
    <Dialog id="dlgKeyPointQuotaItemView">
      <Property name="maximized">true</Property>
      <Property name="maximizeable">true</Property>
      <Property name="shadowMode">none</Property>
      <Property name="resizeable">false</Property>
      <Property name="minWidth">100%</Property>
      <Property name="minHeight">100%</Property>
      <Property name="maxWidth">100%</Property>
      <Property name="maxHeight">100%</Property>
      <Property name="height">100%</Property>
      <Property name="width">100%</Property>
      <Property name="autoAdjustPosition">false</Property>
      <Buttons/>
      <Children>
        <DataSet id="dsPointQuotaViewHtml">
          <Property name="dataType">String</Property>
          <Property name="dataProvider">poiReadExcel#getHtml</Property>
        </DataSet>
        <ToolBar>
          <Property name="fixRight">true</Property>
          <Property name="draggable">true</Property>
          <Property name="hideMode">visibility</Property>
          <ToolBarLabel>
            <Property name="text">年度</Property>
          </ToolBarLabel>
          <TextEditor id="teYear2">
            <ClientEvent name="onReady">var date=new Date();&#xD;
var year;&#xD;
var month=date.getMonth();&#xD;
&#xD;
var Sys = {};&#xD;
var ua = navigator.userAgent.toLowerCase();&#xD;
window.ActiveXObject ? Sys.ie = ua.match(/msie ([\d.]+)/)[1] :&#xD;
document.getBoxObjectFor ? Sys.firefox = ua.match(/firefox\/([\d.]+)/)[1] :&#xD;
window.MessageEvent &amp;&amp; !document.getBoxObjectFor ? Sys.chrome = ua.match(/chrome\/([\d.]+)/)[1] :&#xD;
window.opera ? Sys.opera = ua.match(/opera.([\d.]+)/)[1] :&#xD;
window.openDatabase ? Sys.safari = ua.match(/version\/([\d.]+)/)[1] : 0;&#xD;
&#xD;
//以下进行测试&#xD;
if(Sys.ie){&#xD;
	year=(date.getYear());&#xD;
}else if(Sys.chrome){&#xD;
	year=(date.getYear())+1900;&#xD;
}&#xD;
&#xD;
if(month==0){&#xD;
	year=year-1;&#xD;
}&#xD;
self.set(&quot;text&quot;,year);&#xD;
view.set(&quot;context.year&quot;,year);</ClientEvent>
            <Property name="trigger">yddYear</Property>
            <Property name="width">70</Property>
          </TextEditor>
          <ToolBarLabel>
            <Property name="text">月度</Property>
          </ToolBarLabel>
          <TextEditor id="teMonth2">
            <ClientEvent name="onReady">var date=new Date();&#xD;
var year;&#xD;
var month=date.getMonth();&#xD;
&#xD;
if(month==0){&#xD;
	month=12;&#xD;
}&#xD;
self.set(&quot;text&quot;,month);&#xD;
view.set(&quot;context.month&quot;,month);</ClientEvent>
            <Property name="trigger">lddMonth2</Property>
            <Property name="width">70</Property>
          </TextEditor>
          <Separator/>
          <ToolBarButton>
            <ClientEvent name="onClick">teYear2=view.get(&quot;#teYear2&quot;);&#xD;
year=parseInt(teYear2.get(&quot;text&quot;));&#xD;
teMonth2=view.get(&quot;#teMonth2&quot;);&#xD;
month=teMonth2.get(&quot;text&quot;);&#xD;
dsPointQuotaViewHtml=view.get(&quot;#dsPointQuotaViewHtml&quot;);&#xD;
hc1=view.get(&quot;#hc1&quot;);&#xD;
aaWriteExcel=view.get(&quot;#aaWriteExcel&quot;);&#xD;
dlgKeyPointQuotaItemView=view.get(&quot;#dlgKeyPointQuotaItemView&quot;);&#xD;
&#xD;
aaWriteExcel.set(&quot;parameter&quot;,{year:year,month:month});&#xD;
aaWriteExcel.execute({&#xD;
	callback : function(success, obj){&#xD;
		if (success) {&#xD;
			dsPointQuotaViewHtml.flush();&#xD;
			var html=dsPointQuotaViewHtml.getData();&#xD;
			hc1.refresh(true);&#xD;
			hc1.set(&quot;content&quot;,html);&#xD;
			hc1.refresh(true);&#xD;
        }&#xD;
	}&#xD;
});</ClientEvent>
            <Property name="caption">查看</Property>
            <Property name="icon">url(>skin>common/icons.gif) -220px -80px</Property>
          </ToolBarButton>
          <ToolBarButton>
            <ClientEvent name="onClick">var teYear2=view.get(&quot;#teYear2&quot;);&#xD;
var year=parseInt(teYear2.get(&quot;text&quot;));&#xD;
var teMonth2=view.get(&quot;#teMonth2&quot;);&#xD;
var month=teMonth2.get(&quot;text&quot;);&#xD;
var aaDownLoadFile=view.get(&quot;#aaDownLoadFile&quot;);&#xD;
&#xD;
aaDownLoadFile.set(&quot;parameter&quot;,{year:year,month:month});&#xD;
aaDownLoadFile.execute();</ClientEvent>
            <Property name="caption">下载</Property>
            <Property name="visible">true</Property>
            <Property name="icon">url(>skin>common/icons.gif) -140px -240px</Property>
          </ToolBarButton>
        </ToolBar>
        <HtmlContainer id="hc1" listener="spring:keyPointQuotaItemViewInit#Hc1Init">
          <Property name="visible">true</Property>
          <Property name="hideMode">visibility</Property>
          <Property name="containerUi">default</Property>
          <Property name="draggable">false</Property>
          <Property name="droppable">false</Property>
        </HtmlContainer>
      </Children>
      <Tools/>
    </Dialog>
  </View>
</ViewConfig>
